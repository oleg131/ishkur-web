<script
  src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.3/howler.min.js"
  integrity="sha512-6+YN/9o9BWrk6wSfGxQGpt3EUK6XeHi6yeHV+TYD2GR0Sj/cggRpXr1BrAQf0as6XslxomMUxXp2vIl+fv0QRA=="
  crossorigin="anonymous"
  referrerpolicy="no-referrer"
></script>

<button>Stop</button>

<script>
  var srcNode;

  var sound = new Howl({
    src: ["/output.m4a"],
  });

  sound.play();

  document.querySelector("button").onclick = function () {
    if (srcNode) {
      srcNode = false;
      this.innerText = "Stodp";
      sound.play();
    } else {
      srcNode = true;
      this.innerText = "Plady";
      sound.stop();
    }
  };
</script>

<!-- <button>Stop</button>

<script>
  var actx = new (AudioContext || webkitAudioContext)(),
    src = "http://localhost:3000/output.mp3",
    audioData,
    srcNode; // global so we can access them from handlers

  // Load some audio (CORS need to be allowed or we won't be able to decode the data)
  fetch(src, { mode: "cors" })
    .then(function (resp) {
      return resp.arrayBuffer();
    })
    .then(decode);

  // Decode the audio file, then start the show
  function decode(buffer) {
    actx.decodeAudioData(buffer, playLoop);
  }

  // Sets up a new source node as needed as stopping will render current invalid
  function playLoop(abuffer) {
    if (!audioData) audioData = abuffer; // create a reference for control buttons
    srcNode = actx.createBufferSource(); // create audio source
    srcNode.buffer = abuffer; // use decoded buffer
    srcNode.connect(actx.destination); // create output
    srcNode.loop = true; // takes care of perfect looping
    srcNode.start(); // play...
  }

  // Simple example control
  document.querySelector("button").onclick = function () {
    if (srcNode) {
      srcNode.stop();
      srcNode = null;
      this.innerText = "Play";
    } else {
      playLoop(audioData);
      this.innerText = "Stop";
    }
  };
</script> -->

<!--
<audio id="music" loop controls>
  <source src="http://localhost:3000/output.ogg" />
</audio>

<script type="text/javascript">
  (function () {
    function loopify(uri, cb) {
      var context = new (window.AudioContext || window.webkitAudioContext)(),
        request = new XMLHttpRequest();

      request.responseType = "arraybuffer";
      request.open("GET", uri, true);

      // XHR failed
      request.onerror = function () {
        cb(new Error("Couldn't load audio from " + uri));
      };

      // XHR complete
      request.onload = function () {
        context.decodeAudioData(request.response, success, function (err) {
          // Audio was bad
          cb(new Error("Couldn't decode audio from " + uri));
        });
      };

      request.send();

      function success(buffer) {
        var source;

        function play() {
          // Stop if it's already playing
          stop();

          // Create a new source (can't replay an existing source)
          source = context.createBufferSource();
          source.connect(context.destination);

          // Set the buffer
          source.buffer = buffer;
          source.loop = true;

          // Play it
          source.start(0);
        }

        function stop() {
          // Stop and clear if it's playing
          if (source) {
            source.stop();
            source = null;
          }
        }

        cb(null, {
          play: play,
          stop: stop,
        });
      }
    }

    loopify.version = "0.1";

    if (typeof define === "function" && define.amd) {
      define(function () {
        return loopify;
      });
    } else if (typeof module === "object" && module.exports) {
      module.exports = loopify;
    } else {
      this.loopify = loopify;
    }
  })();
</script> -->

<!--
<script>
  // SUpply an audio filename and a callback
  loopify(
    "http://localhost:3000/tracks/goatrance/SOUND/goatrance[0].mp3",
    function (err, loop) {
      // If something went wrong, `err` is supplied
      if (err) {
        return console.error(err);
      }

      // Play it whenever you want
      loop.play();

      // Stop it later if you feel like it
      loop.stop();
    }
  );
</script> -->

<!-- <link href="gapless5.css" rel="stylesheet" type="text/css" />
<script src="gapless5.js" language="JavaScript" type="text/javascript"></script>

<div id="gapless5-player-id" />

<script>
  const player = new Gapless5({
    guiId: "gapless5-player-id",
    loop: true,
    singleMode: true,
  });

  // You can add tracks by relative or absolute URL:
  player.addTrack(
    "http://localhost:3000/tracks/goatrance/SOUND/goatrance[1].m4a"
  );

  // You can also let the user upload tracks from a file loader like this:

  player.play();

  document.querySelector("button").onclick = function () {
    console.log(11);
    player.pause();
  };
</script> -->
